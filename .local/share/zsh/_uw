#compdef uw

_uw() {
  local state line
  typeset -A opt_args

  _arguments -C \
    ':list of commands:->cmds' \
    ':command arguments:->args' \
    '*:available keys:->args'

  case "$state" in
    cmds)
      local commands
      commands=(
        'new:create a new branch from latest local dev db (new tickets)'
        'clone:clone an existing branch (UATs or testing)'
        'uli:get lando url and copy to clipboard'
        'rm:destroy lando, and remove local branch'
        'site-install:install a new site'
        'dev-update:update latest dev branch (UW2-dev directory)'
        'debug:enable debug, which requires a "lando rebuild -y"'
      )
      _describe -t commands 'command' commands
      ;;
    args)
      case ${line[1]} in
        rm)
          local -a keys
          uw ls tickets \
            | while read k; do
              keys+=("$k")
            done
          _describe -t arguments 'argument' keys
          ;;
        site-install)
          local -a keys
          uw ls sites \
            | while read k; do
              keys+=("$k")
            done
          _describe -t arguments 'argument' keys
          ;;
      esac
      ;;
  esac

  return 1
}

# vim: ft=sh
