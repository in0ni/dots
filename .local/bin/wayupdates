#!/bin/sh

pacman=$(checkupdates | wc -l)
pacaur=$(yay -Qua | wc -l)
fwupd=$(fwupdmgr get-updates 2> /dev/null | grep -E "^(├─|└─)" | wc -l)

status=""

if [ "$pacman" -gt 0 -o "$pacaur" -gt 0 ]; then
  if [ "$pacman" -gt 0 ]; then
    status="*"
  else
    status=""
  fi
fi

if [ $fwupd -gt 0 ]; then
 status="${status} "
fi

if [ "$status" != "" ]; then
  echo "{\"text\": \"$status\",\"tooltip\":\"(${pacman}) pkg, (${pacaur}) aur, (${fwupd}) fw\"}"
fi
